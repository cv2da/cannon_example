
#SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.

include ${TRICK_HOME}/share/trick/makefiles/Makefile.common

# Flags passed to the preprocessor.
TRICK_CXXFLAGS += -I$(GTEST_HOME)/include -I$(TRICK_HOME)/include -g -Wall -Wextra ${TRICK_SYSTEM_CXXFLAGS} ${TRICK_TEST_FLAGS}

TRICK_LIBS = ${TRICK_LIB_DIR}/libtrick.a
TRICK_EXEC_LINK_LIBS += -L${GTEST_HOME}/lib64 -L${GTEST_HOME}/lib -lgtest -lgtest_main -lpthread

# Added for Ubuntu... not required for other systems.
TRICK_EXEC_LINK_LIBS += -lpthread

# All tests produced by this Makefile.  Remember to add new tests you
# created to the list.
TESTS = dbl_is_near_unittest flt_is_near_unittest

OTHER_OBJECTS =

# House-keeping build targets.

all : $(TESTS)

test: $(TESTS)
	./dbl_is_near_unittest --gtest_output=xml:${TRICK_HOME}/trick_test/dbl_is_near.xml
	./flt_is_near_unittest --gtest_output=xml:${TRICK_HOME}/trick_test/flt_is_near.xml

clean :
	rm -f $(TESTS) *.o
	rm -rf io_src xml

dbl_is_near_unittest.o : dbl_is_near_unittest.cc
	$(TRICK_CXX) $(TRICK_CXXFLAGS) -c $<

dbl_is_near_unittest : dbl_is_near_unittest.o
	$(TRICK_CXX) $(TRICK_CXXFLAGS) -o $@ $^ $(OTHER_OBJECTS) -L${TRICK_HOME}/lib_${TRICK_HOST_CPU} $(TRICK_LIBS) $(TRICK_EXEC_LINK_LIBS)

flt_is_near_unittest.o : flt_is_near_unittest.cc
	$(TRICK_CXX) $(TRICK_CXXFLAGS) -c $<

flt_is_near_unittest : flt_is_near_unittest.o
	$(TRICK_CXX) $(TRICK_CXXFLAGS) -o $@ $^ $(OTHER_OBJECTS) -L${TRICK_HOME}/lib_${TRICK_HOST_CPU} $(TRICK_LIBS) $(TRICK_EXEC_LINK_LIBS)
